# Support Dashboard –¥–ª—è –ê–ª–µ–∫—Å 24/7

–ó–∞—â–∏—â–µ–Ω–Ω–∞—è –ø–∞—Ä–æ–ª–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö –±–æ—Ç–∞.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîí –ó–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–º
- üë§ –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `alex_users`
- üß† –¢–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ `alex_user_therapy_profiles`
- üí≥ –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –∏–∑ `alex_payments`
- üí¨ –í–µ—Å—å –¥–∏–∞–ª–æ–≥ —Å –±–æ—Ç–æ–º –∏–∑ `alex_chat_logs`
- üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- PostgreSQL (Yandex Cloud Managed PostgreSQL)
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç PostgreSQL –≤ `~/.postgresql/root.crt`

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
cd support-dashboard
npm install
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:
```bash
cp .env.example .env
```

3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env` —Ñ–∞–π–ª:
```env
# PostgreSQL Connection
PGUSER=your_username
PGPASSWORD=your_password
PGHOST=your_host.mdb.yandexcloud.net
PGPORT=6432
PGDATABASE=your_database

# Server
PORT=3005

# Support Dashboard Password
SUPPORT_PASSWORD=your_secure_password_here
```

4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç PostgreSQL –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `~/.postgresql/root.crt`

## üèÉ –ó–∞–ø—É—Å–∫

### Development
```bash
npm start
```

### Production (—Å PM2)
```bash
pm2 start src/server.js --name support-dashboard
```

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:3005`

## üåê –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm install`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env` —Ñ–∞–π–ª
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ PM2:
```bash
pm2 start src/server.js --name support-dashboard
pm2 save
```

5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Nginx –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è:
```nginx
server {
    listen 80;
    server_name support.your-domain.ru;

    location / {
        proxy_pass http://localhost:3005;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## üîê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å (–∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `SUPPORT_PASSWORD`)
3. –í–≤–µ–¥–∏—Ç–µ `telegram_user_id` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
4. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üìä API Endpoints

### POST `/api/auth`
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
```json
{
  "password": "your_password"
}
```

### GET `/api/user/:telegramUserId`
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç—Ä–µ–±—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Support-Password`)

### GET `/api/user/:telegramUserId/info`
–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

### GET `/api/user/:telegramUserId/chat?limit=100`
–ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

### GET `/health`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ API endpoint'—ã –∑–∞—â–∏—â–µ–Ω—ã –ø–∞—Ä–æ–ª–µ–º —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Support-Password`
- –ü–∞—Ä–æ–ª—å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –°–µ—Å—Å–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `sessionStorage` –±—Ä–∞—É–∑–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SSL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
support-dashboard/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ postgres.js      # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏ –∑–∞–ø—Ä–æ—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ server.js             # Express —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ index.html            # HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ styles.css            # –°—Ç–∏–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ app.js                # Frontend –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ .env.example              # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `~/.postgresql/root.crt`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å credentials –≤ `.env`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ IP —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω –≤ whitelist Yandex Cloud

### –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: `pm2 status`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs support-dashboard`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—Ä—Ç 3005 –Ω–µ –∑–∞–Ω—è—Ç

### –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `SUPPORT_PASSWORD` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`
- –û—á–∏—Å—Ç–∏—Ç–µ `sessionStorage` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ console –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
